He then led Union forces to victory after initial setbacks in the Battle of Shiloh , earning a reputation as an aggressive commander.
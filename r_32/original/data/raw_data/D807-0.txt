Madrid (, ) is the capital and largest city of Spain .
In a heat engine , internal energy of bodies is harnessed to provide useful work .
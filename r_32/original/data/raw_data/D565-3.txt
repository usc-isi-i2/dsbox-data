He was given the honor of commanding the Union troops at the surrender ceremony for the infantry of Robert E. Lee 's Army at Appomattox , Virginia.
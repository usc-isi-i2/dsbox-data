Settled in 1730, Shippensburg lies in the Cumberland Valley , 41 miles (66 km) west-southwest of Harrisburg , and is part of the Harrisburgâ€“ Carlisle Metropolitan Statistical Area .
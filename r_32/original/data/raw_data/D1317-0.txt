Barnabus 'Barney' Stinson (born 1976) is a fictional character created by Carter Bays and Craig Thomas for the CBS television series How I Met Your Mother , portrayed by Neil Patrick Harris .
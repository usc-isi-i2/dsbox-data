While several jurisdictions have legalized same-sex marriage through court rulings, legislative action, and popular vote , nine states prohibit same-sex marriage by statute and 30 prohibit it in their constitutions .
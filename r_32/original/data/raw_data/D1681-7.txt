Low ridges to the northwest of town were defended initially by a Union cavalry division under Brig. Gen. John Buford , and soon reinforced with two corps of Union infantry .
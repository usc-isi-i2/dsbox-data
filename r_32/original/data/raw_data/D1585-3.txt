The story was by Sam Fell, Peter Lord , Dick Clement , and Ian La Frenais , and the screenplay was written by Dick Clement, Ian La Frenais, Christopher Lloyd , Joe Keenan, and William Davies .
In 1863, Robert E. Lee's Confederate incursion north ended at the Battle of Gettysburg .